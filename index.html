<!doctype html>
<html>
<head>
	<title>HSTS Study</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
	<style type="text/css">
		h1, h2 {
			margin-top: 24px;
		}
	</style>
</head>
<body>
	<nav id="navbar-hsts" class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
		<div class="container">
			<a class="navbar-brand" href="/">HSTS Study</a>
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarContent" aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>

			<div class="collapse navbar-collapse" id="navbarContent">
				<ul class="navbar-nav mr-auto">
					<li class="nav-item">
						<a class="nav-link" href="#about">About</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#adoption">Adoption</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#configuration">Configuration</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#inconsistencies">Inconsistencies</a>
					</li>
				</ul>
			</div>
		</div>
	</nav>

	<div style="height: 100vh; padding-top: 56px;">
		<div style="overflow-y: scroll; height: 100%;" data-spy="scroll" data-target="#navbar-hsts" data-offset="56">
			<div class="container">
				<h2 id="about">About this Study</h2>
				<p>
					A browser respecting the <code>Strict-Transport-Security</code> header (defined in <a href="https://tools.ietf.org/html/rfc6797">RFC 6797</a>) will access the website sending this header only via a secure connection for the following requests. This prevents e.g. session cookies to be leaked by being sent through insecure connections.
				</p>
				<p>
					All of the charts can be viewed in absolute values as number of domains, or in relative values as percentage of scaned domans or domains with sts enabled. Additionally the data set can be selected with "IPv4" showing only data for domains that were scaned via IPv4, "IPv6" respecitvely for domains scaned via IPv6 and "Merged" showing data for both of the previous scans merged by the domain.
				</p>
				<p>
					This study is part of the bachelor thesis "Long Term Analysis of the HTTP Strict Transport Security Header".
				</p>
				<h2 id="adoption">Adoption</h2>
				<div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Chart options">
					<div class="nav btn-group btn-group-toggle" id="adoption-tabs" data-toggle="buttons" role="tablist">
						<label class="nav-link btn btn-secondary active" id="adoption-scope-absolute-tab" data-toggle="tab" href="#adoption-absolute" role="tab" aria-controls="adoption-absolute" aria-selected="true">
							<input type="radio" name="adoption-scope" id="adoption-scope-absolute-radio" autocomplete="off" checked> Absolute
						</label>
						<label class="nav-link btn btn-secondary" id="adoption-scope-relative-tab" data-toggle="tab" href="#adoption-relative" role="tab" aria-controls="adoption-relative" aria-selected="false">
							<input type="radio" name="adoption-scope" id="adoption-scope-relative-radio" autocomplete="off"> Relative
						</label>
					</div>
					<div class="btn-group btn-group-toggle data-set-toggle" data-chart="adoption" data-toggle="buttons">
						<label class="btn btn-secondary">
							<input type="radio" name="adoption-set" id="adoption-set-ipv4" data-set="ipv4" autocomplete="off"> IPv4
						</label>
						<label class="btn btn-secondary">
							<input type="radio" name="adoption-set" id="adoption-set-ipv6" data-set="ipv6" autocomplete="off"> IPv6
						</label>
						<label class="btn btn-secondary active">
							<input type="radio" name="adoption-set" id="adoption-set-merged" data-set="merged" autocomplete="off" checked> Merged
						</label>
					</div>
				</div>
				<div class="tab-content" id="adoption-tab-content">
					<div class="tab-pane fade show active" id="adoption-absolute" role="tabpanel" aria-labelledby="adoption-scope-absolute-tab" style="width: 100%;height: 400px;"></div>
					<div class="tab-pane fade" id="adoption-relative" role="tabpanel" aria-labelledby="adoption-scope-relative-tab" style="width: 100%;height: 400px;"></div>
				</div>
				<p>
					<small>Note: Domains with parse errors might still have a valid HSTS header if all required directives could be parsed, but some optional directives could not be.</small>
				</p>

				<h2 id="configuration">Configuration</h2>
				<p>
					The HSTS header can be configured with the three directives <code>max-age</code>, <code>includeSubDomains</code> and <code>preload</code> (with the later one not being defined in the official RFC, but being used by most browsers to generate their preloading lists).
				</p>
				<p>
					The <code>max-age</code> directive is required for the header to be valid and can have any positive integer value. This value specifies the duration in seconds for which the strict transport security policy should be active. The spread of the value used for this direcitve can be seen in the following chart.
				</p>

				<div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Chart options">
					<div class="nav btn-group btn-group-toggle" id="max-age-tabs" data-toggle="buttons" role="tablist">
						<label class="nav-link btn btn-secondary active" id="max-age-scope-absolute-tab" data-toggle="tab" href="#max-age-absolute" role="tab" aria-controls="max-age-absolute" aria-selected="true">
							<input type="radio" name="max-age-scope" id="max-age-scope-absolute-radio" autocomplete="off" checked> Absolute
						</label>
						<label class="nav-link btn btn-secondary" id="max-age-scope-relative-tab" data-toggle="tab" href="#max-age-relative" role="tab" aria-controls="max-age-relative" aria-selected="false">
							<input type="radio" name="max-age-scope" id="max-age-scope-relative-radio" autocomplete="off"> Relative
						</label>
					</div>
					<div class="btn-group btn-group-toggle data-set-toggle" data-chart="max-age" data-toggle="buttons">
						<label class="btn btn-secondary">
							<input type="radio" name="max-age-set" id="max-age-set-ipv4" data-set="ipv4" autocomplete="off"> IPv4
						</label>
						<label class="btn btn-secondary">
							<input type="radio" name="max-age-set" id="max-age-set-ipv6" data-set="ipv6" autocomplete="off"> IPv6
						</label>
						<label class="btn btn-secondary active">
							<input type="radio" name="max-age-set" id="max-age-set-merged" data-set="merged" autocomplete="off" checked> Merged
						</label>
					</div>
				</div>
				<div class="tab-content" id="max-age-tab-content">
					<div class="tab-pane fade show active" id="max-age-absolute" role="tabpanel" aria-labelledby="max-age-scope-absolute-tab" style="width: 100%;height: 400px;"></div>
					<div class="tab-pane fade" id="max-age-relative" role="tabpanel" aria-labelledby="max-age-scope-relative-tab" style="width: 100%;height: 400px;"></div>
				</div>

				<p>
					The other two directives do not have any values, but can either be set or not. The <code>includeSubDomains</code> direcitve extens the strict transport security policy to any subdomains of the domain that the HSTS header was sent initially. By setting <code>preload</code> directive the owner of a website allows its domain to be included in preload lists that come with most browsers.
				</p>

				<div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Chart options">
					<div class="nav btn-group btn-group-toggle" id="configuration-tabs" data-toggle="buttons" role="tablist">
						<label class="nav-link btn btn-secondary active" id="configuration-scope-absolute-tab" data-toggle="tab" href="#configuration-absolute" role="tab" aria-controls="configuration-absolute" aria-selected="true">
							<input type="radio" name="configuration-scope" id="configuration-scope-absolute-radio" autocomplete="off" checked> Absolute
						</label>
						<label class="nav-link btn btn-secondary" id="configuration-scope-relative-tab" data-toggle="tab" href="#configuration-relative" role="tab" aria-controls="configuration-relative" aria-selected="false">
							<input type="radio" name="configuration-scope" id="configuration-scope-relative-radio" autocomplete="off"> Relative
						</label>
					</div>
					<div class="btn-group btn-group-toggle data-set-toggle" data-chart="configuration" data-toggle="buttons">
						<label class="btn btn-secondary">
							<input type="radio" name="configuration-set" id="configuration-set-ipv4" data-set="ipv4" autocomplete="off"> IPv4
						</label>
						<label class="btn btn-secondary">
							<input type="radio" name="configuration-set" id="configuration-set-ipv6" data-set="ipv6" autocomplete="off"> IPv6
						</label>
						<label class="btn btn-secondary active">
							<input type="radio" name="configuration-set" id="configuration-set-merged" data-set="merged" autocomplete="off" checked> Merged
						</label>
					</div>
				</div>
				<div class="tab-content" id="configuration-tab-content">
					<div class="tab-pane fade show active" id="configuration-absolute" role="tabpanel" aria-labelledby="configuration-scope-absolute-tab" style="width: 100%;height: 400px;"></div>
					<div class="tab-pane fade" id="configuration-relative" role="tabpanel" aria-labelledby="configuration-scope-relative-tab" style="width: 100%;height: 400px;"></div>
				</div>

				<h2 id="inconsistencies">Inconsistencies</h2>

				<p>
					This section shows inconsistencies in the configuration and existence of the HSTS header between scans of a website of a single domain being served via different IP addresses.
				</p>
				<p>
					The following chart shows inconsistencies across multiple IP address of the same version for a single domain.
					An inconsistency in the configuration of the HSTS header requires any of the directives to have differing values, or being set when the website is served on one IP address, but not being set when the webiste is servert on another IP address.
					A domain is inconsistent in the existence of the HSTS header if it is being sent on one IP, but not on another IP of the same domain.
					The total inconsistencies statistic shows the domains with any of the above inconsistencies.
				</p>

				<div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Chart options">
					<div class="nav btn-group btn-group-toggle" id="inconsistencies-tabs" data-toggle="buttons" role="tablist">
						<label class="nav-link btn btn-secondary active" id="inconsistencies-scope-absolute-tab" data-toggle="tab" href="#inconsistencies-absolute" role="tab" aria-controls="inconsistencies-absolute" aria-selected="true">
							<input type="radio" name="inconsistencies-scope" id="inconsistencies-scope-absolute-radio" autocomplete="off" checked> Absolute
						</label>
						<label class="nav-link btn btn-secondary" id="inconsistencies-scope-relative-tab" data-toggle="tab" href="#inconsistencies-relative" role="tab" aria-controls="inconsistencies-relative" aria-selected="false">
							<input type="radio" name="inconsistencies-scope" id="inconsistencies-scope-relative-radio" autocomplete="off"> Relative
						</label>
					</div>
					<div class="btn-group btn-group-toggle data-set-toggle" data-chart="inconsistencies" data-toggle="buttons">
						<label class="btn btn-secondary active">
							<input type="radio" name="inconsistencies-set" id="inconsistencies-set-ipv4" data-set="ipv4" autocomplete="off" checked> IPv4
						</label>
						<label class="btn btn-secondary">
							<input type="radio" name="inconsistencies-set" id="inconsistencies-set-ipv6" data-set="ipv6" autocomplete="off"> IPv6
						</label>
					</div>
				</div>
				<div class="tab-content" id="inconsistencies-tab-content">
					<div class="tab-pane fade show active" id="inconsistencies-absolute" role="tabpanel" aria-labelledby="inconsistencies-scope-absolute-tab" style="width: 100%;height: 400px;"></div>
					<div class="tab-pane fade" id="inconsistencies-relative" role="tabpanel" aria-labelledby="inconsistencies-scope-relative-tab" style="width: 100%;height: 400px;"></div>
				</div>

				<p>
					Inconsistencies between different IP versions are found by defining a set of quad tuples for each IP version. Every quad tuple contains whether a valid HSTS header was set, the value of the <code>max-age</code> directive and whether the <code>includeSubDomains</code> and <code>preload</code> directives were set. If such a quad tuple is found in the set for one IP version, but not for the other, the domain being served on those IP addresses is considered inconsistent between IP versions.
				</p>

				<div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Chart options">
					<div class="nav btn-group btn-group-toggle" id="inconsistency-v4v6-tabs" data-toggle="buttons" role="tablist">
						<label class="nav-link btn btn-secondary active" id="inconsistency-v4v6-scope-absolute-tab" data-toggle="tab" href="#inconsistency-v4v6-absolute" role="tab" aria-controls="inconsistency-v4v6-absolute" aria-selected="true">
							<input type="radio" name="inconsistency-v4v6-scope" id="inconsistency-v4v6-scope-absolute-radio" autocomplete="off" checked> Absolute
						</label>
						<label class="nav-link btn btn-secondary" id="inconsistency-v4v6-scope-relative-tab" data-toggle="tab" href="#inconsistency-v4v6-relative" role="tab" aria-controls="inconsistency-v4v6-relative" aria-selected="false">
							<input type="radio" name="inconsistency-v4v6-scope" id="inconsistency-v4v6-scope-relative-radio" autocomplete="off"> Relative
						</label>
					</div>
				</div>
				<div class="tab-content" id="inconsistency-v4v6-tab-content">
					<div class="tab-pane fade show active" id="inconsistency-v4v6-absolute" role="tabpanel" aria-labelledby="inconsistency-v4v6-scope-absolute-tab" style="width: 100%;height: 400px;"></div>
					<div class="tab-pane fade" id="inconsistency-v4v6-relative" role="tabpanel" aria-labelledby="inconsistency-v4v6-scope-relative-tab" style="width: 100%;height: 400px;"></div>
				</div>
			</div>
		</div>
	</div>

	<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
	<script src="https://code.highcharts.com/highcharts.src.js"></script>
	<script type="text/javascript" src="chart.js"></script>
	<script type="text/javascript">
		$(function(){
			var chartMap = {};

			$('.data-set-toggle').delegate('input[type="radio"]', 'change', function(event) {
				var group = $(event.delegateTarget);
				var option = $(event.currentTarget);

				var id = group.data('chart');
				var set = option.data('set');

				var chart = chartMap[id];
				if (chart) {
					chart.load(set);
				}
			});

			chartMap['adoption'] = new Chart('adoption',
				{
					'chart': {
						'type': 'spline',
						'zoomType': 'xy'
					},
					'title': {
						'text': "HSTS Adoption"
					},
					'tooltip': {
						'headerFormat': "<b>{series.name}</b><br/>",
						'pointFormat': "<span>{point.x:%e. %b %Y}</span><br/><span>{point.y:,.0f} domains</span>"
					},
					'xAxis': {
						'title': {
							'text': "Date"
						},
						'type': 'datetime',
						'dateTimeLabelFormats': {
							'day': '%e. %b %Y',
							'month': '%b %Y',
							'year': '%Y'
						}
					},
					'yAxis': {
						'title': {
							'text': "# domains"
						},
						'min': 0
					},
					'plotOptions': {
						'spline': {
							'marker': {
								'enabled': true,
								'radius': 2 
							}
						}
					},
					'series': [
						{
							'name': "Domains with HSTS",
							'data': []
						}, {
							'name': "Domains with parse errors",
							'data': []
						}
					]
				},
				{
					'chart': {
						'type': 'spline',
						'zoomType': 'xy'
					},
					'title': {
						'text': "HSTS Adoption"
					},
					'tooltip': {
						'headerFormat': "<b>{series.name}</b><br/>",
						'pointFormat': "<span>{point.x:%e. %b %Y}</span><br/><span>{point.y:.2f}% of scaned domains</span>"
					},
					'xAxis': {
						'title': {
							'text': "Date"
						},
						'type': 'datetime',
						'dateTimeLabelFormats': {
							'day': '%e. %b %Y',
							'month': '%b %Y',
							'year': '%Y'
						}
					},
					'yAxis': {
						'title': {
							'text': "% of scaned domains"
						},
						'min': 0
					},
					'plotOptions': {
						'spline': {
							'marker': {
								'enabled': true,
								'radius': 2 
							}
						}
					},
					'series': [
						{
							'name': "Domains with HSTS",
							'data': []
						}, {
							'name': "Domains with parse errors",
							'data': []
						}
					]
				},
				new DataResolver(true, true, ['hsts', 'parseError'])
			);

			chartMap['configuration'] = new Chart('configuration',
				{
					'chart': {
						'type': 'spline',
						'zoomType': 'xy'
					},
					'title': {
						'text': "HSTS Configuration"
					},
					'tooltip': {
						'headerFormat': "<b>{series.name}</b><br/>",
						'pointFormat': "<span>{point.x:%e. %b %Y}</span><br/><span>{point.y:,.0f} domains</span>"
					},
					'xAxis': {
						'title': {
							'text': "Date"
						},
						'type': 'datetime',
						'dateTimeLabelFormats': {
							'day': '%e. %b %Y',
							'month': '%b %Y',
							'year': '%Y'
						}
					},
					'yAxis': {
						'title': {
							'text': "# domains"
						},
						'min': 0
					},
					'plotOptions': {
						'spline': {
							'marker': {
								'enabled': true,
								'radius': 2 
							}
						}
					},
					'series': [
						{
							'name': "includeSubDomains",
							'data': []
						}, {
							'name': "preload",
							'data': []
						}
					]
				},
				{
					'chart': {
						'type': 'spline',
						'zoomType': 'xy'
					},
					'title': {
						'text': "HSTS Configuration"
					},
					'tooltip': {
						'headerFormat': "<b>{series.name}</b><br/>",
						'pointFormat': "<span>{point.x:%e. %b %Y}</span><br/><span>{point.y:.2f}% of domains with sts</span>"
					},
					'xAxis': {
						'title': {
							'text': "Date"
						},
						'type': 'datetime',
						'dateTimeLabelFormats': {
							'day': '%e. %b %Y',
							'month': '%b %Y',
							'year': '%Y'
						}
					},
					'yAxis': {
						'title': {
							'text': "% of domains with sts"
						},
						'min': 0
					},
					'plotOptions': {
						'spline': {
							'marker': {
								'enabled': true,
								'radius': 2 
							}
						}
					},
					'series': [
						{
							'name': "includeSubDomains",
							'data': []
						}, {
							'name': "preload",
							'data': []
						}
					]
				},
				new DataResolver(true, true, ['includeSubDomains', 'preload'])
			);

			chartMap['max-age'] = new Chart('max-age',
				{
					'chart': {
						'type': 'area',
						'zoomType': 'xy'
					},
					'title': {
						'text': "max-age values"
					},
					'tooltip': {
						'headerFormat': "<b>{series.name}</b><br/>",
						'pointFormat': "<span>{point.x:%e. %b %Y}</span><br/><span>{point.y:,.0f} domains</span>"
					},
					'xAxis': {
						'title': {
							'text': "Date"
						},
						'type': 'datetime',
						'dateTimeLabelFormats': {
							'day': '%e. %b %Y',
							'month': '%b %Y',
							'year': '%Y'
						}
					},
					'yAxis': {
						'title': {
							'text': "# domains"
						},
						'min': 0
					},
					'plotOptions': {
						'area': {
							'stacking': 'normal',
							'marker': {
								'enabled': true,
								'radius': 2 
							}
						}
					},
					'series': [
						{
							'name': ">1 year",
							'data': []
						}, {
							'name': "1 year",
							'data': []
						}, {
							'name': "6 months",
							'data': []
						}, {
							'name': "30 days",
							'data': []
						}, {
							'name': "1 week",
							'data': []
						}, {
							'name': "off",
							'data': []
						}
					]
				},
				{
					'chart': {
						'type': 'area',
						'zoomType': 'xy'
					},
					'title': {
						'text': "max-age values"
					},
					'tooltip': {
						'headerFormat': "<b>{series.name}</b><br/>",
						'pointFormat': "<span>{point.x:%e. %b %Y}</span><br/><span>{point.y:.2f}% of domains with sts</span>"
					},
					'xAxis': {
						'title': {
							'text': "Date"
						},
						'type': 'datetime',
						'dateTimeLabelFormats': {
							'day': '%e. %b %Y',
							'month': '%b %Y',
							'year': '%Y'
						}
					},
					'yAxis': {
						'title': {
							'text': "% of domains with sts"
						},
						'min': 0,
						'max': 100
					},
					'plotOptions': {
						'area': {
							'stacking': 'percent',
							'marker': {
								'enabled': true,
								'radius': 2 
							}
						}
					},
					'series': [
						{
							'name': ">1 year",
							'data': []
						}, {
							'name': "1 year",
							'data': []
						}, {
							'name': "6 months",
							'data': []
						}, {
							'name': "30 days",
							'data': []
						}, {
							'name': "1 week",
							'data': []
						}, {
							'name': "off",
							'data': []
						}
					]
				},
				new DataResolver(false, true, ['other', 'year', 'half-year', 'month', 'week', 'off'])
			);

			chartMap['inconsistencies'] = new Chart('inconsistencies',
				{
					'chart': {
						'type': 'spline',
						'zoomType': 'xy'
					},
					'title': {
						'text': "HSTS Inconsistencies"
					},
					'tooltip': {
						'headerFormat': "<b>{series.name}</b><br/>",
						'pointFormat': "<span>{point.x:%e. %b %Y}</span><br/><span>{point.y:,.0f} domains</span>"
					},
					'xAxis': {
						'title': {
							'text': "Date"
						},
						'type': 'datetime',
						'dateTimeLabelFormats': {
							'day': '%e. %b %Y',
							'month': '%b %Y',
							'year': '%Y'
						}
					},
					'yAxis': {
						'title': {
							'text': "# domains"
						},
						'min': 0
					},
					'plotOptions': {
						'spline': {
							'marker': {
								'enabled': true,
								'radius': 2 
							}
						}
					},
					'series': [
						{
							'name': "total",
							'data': []
						}, {
							'name': "configuration",
							'data': []
						}, {
							'name': "existence",
							'data': []
						}
					]
				},
				{
					'chart': {
						'type': 'spline',
						'zoomType': 'xy'
					},
					'title': {
						'text': "HSTS Inconsistencies"
					},
					'tooltip': {
						'headerFormat': "<b>{series.name}</b><br/>",
						'pointFormat': "<span>{point.x:%e. %b %Y}</span><br/><span>{point.y:.2f}% of domains with sts</span>"
					},
					'xAxis': {
						'title': {
							'text': "Date"
						},
						'type': 'datetime',
						'dateTimeLabelFormats': {
							'day': '%e. %b %Y',
							'month': '%b %Y',
							'year': '%Y'
						}
					},
					'yAxis': {
						'title': {
							'text': "% of domains with sts"
						},
						'min': 0
					},
					'plotOptions': {
						'spline': {
							'marker': {
								'enabled': true,
								'radius': 2 
							}
						}
					},
					'series': [
						{
							'name': "total",
							'data': []
						}, {
							'name': "configuration",
							'data': []
						}, {
							'name': "existence",
							'data': []
						}
					]
				},
				new DataResolver(true, true, ['total', 'configuration', 'existence'])
			);

			chartMap['inconsistency-v4v6'] = new Chart('inconsistency-v4v6',
				{
					'chart': {
						'type': 'spline',
						'zoomType': 'xy'
					},
					'title': {
						'text': "HSTS Inconsistency IPv4 - IPv6"
					},
					'tooltip': {
						'headerFormat': "<b>{series.name}</b><br/>",
						'pointFormat': "<span>{point.x:%e. %b %Y}</span><br/><span>{point.y:,.0f} domains</span>"
					},
					'xAxis': {
						'title': {
							'text': "Date"
						},
						'type': 'datetime',
						'dateTimeLabelFormats': {
							'day': '%e. %b %Y',
							'month': '%b %Y',
							'year': '%Y'
						}
					},
					'yAxis': {
						'title': {
							'text': "# domains"
						},
						'min': 0
					},
					'plotOptions': {
						'spline': {
							'marker': {
								'enabled': true,
								'radius': 2 
							}
						}
					},
					'series': [
						{
							'name': "Inconsistent domains",
							'data': []
						}
					]
				},
				{
					'chart': {
						'type': 'spline',
						'zoomType': 'xy'
					},
					'title': {
						'text': "HSTS Inconsistency IPv4 - IPv6"
					},
					'tooltip': {
						'headerFormat': "<b>{series.name}</b><br/>",
						'pointFormat': "<span>{point.x:%e. %b %Y}</span><br/><span>{point.y:.2f}% of domains with sts</span>"
					},
					'xAxis': {
						'title': {
							'text': "Date"
						},
						'type': 'datetime',
						'dateTimeLabelFormats': {
							'day': '%e. %b %Y',
							'month': '%b %Y',
							'year': '%Y'
						}
					},
					'yAxis': {
						'title': {
							'text': "% of domains with sts"
						},
						'min': 0
					},
					'plotOptions': {
						'spline': {
							'marker': {
								'enabled': true,
								'radius': 2 
							}
						}
					},
					'series': [
						{
							'name': "Inconsistent domains",
							'data': []
						}
					]
				},
				new DataResolver(true, false, ['inconsistent'])
			);

			$.each(chartMap, function(id, chart) {
				if(id == 'inconsistencies') {
					chart.load('ipv4');
				} else {
					chart.load('merged');
				}
			});
		});
	</script>
</body>
</html>
